# 🐟 고래미 원가계산 시스템 (구글시트 연동)

구글 시트를 데이터베이스로 활용하여 제품과 부자재를 관리하는 체계적인 원가계산 시스템입니다.

## 📋 주요 기능

### 🔐 구글 시트 연동
- 구글 시트를 실시간 데이터베이스로 활용
- 제품 및 부자재 정보의 중앙 집중식 관리
- 원가계산 기록의 자동 저장 및 조회

### 📦 데이터 관리
- **제품 관리**: 제품 정보 등록, 수정, 삭제
- **부자재 관리**: 원료, 포장재료, 조미료 등 분류별 관리
- **계산 기록**: 원가계산 결과의 자동 저장 및 이력 관리

### 💰 원가계산
- 구글 시트의 부자재 데이터를 활용한 실시간 원가계산
- 배합비율 기반 원료 투입량 자동 계산
- 포장재료별 비용 자동 계산
- 노무비 및 제조경비 계산
- 이윤률 기반 가격 설정

## 🚀 설치 및 설정

### 1. 필요한 패키지 설치
```bash
pip install -r requirements.txt
```

### 2. 구글 클라우드 설정

#### 2.1 구글 클라우드 콘솔에서 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 새 프로젝트 생성
3. 프로젝트 선택

#### 2.2 Google Sheets API 활성화
1. "API 및 서비스" → "라이브러리" 선택
2. "Google Sheets API" 검색 후 활성화
3. "Google Drive API" 검색 후 활성화

#### 2.3 서비스 계정 생성
1. "API 및 서비스" → "사용자 인증 정보" 선택
2. "사용자 인증 정보 만들기" → "서비스 계정" 선택
3. 서비스 계정 이름 입력 (예: "cost-calculator")
4. "키 만들기" → "JSON" 선택하여 키 파일 다운로드

#### 2.4 구글 시트 템플릿 생성
```bash
python create_google_sheets_template.py service-account-key.json
```

### 3. 프로그램 실행
```bash
streamlit run cost_calculator_with_sheets.py
```

## 📊 구글 시트 구조

### 워크시트 구성
1. **제품목록**: 제품 기본 정보
2. **부자재목록**: 원료, 포장재료, 조미료 등
3. **원가계산기록**: 계산 결과 요약
4. **원료비상세**: 원료별 상세 계산 내역
5. **포장비상세**: 포장재료별 상세 계산 내역
6. **노무비상세**: 노무비 상세 내역
7. **제조경비상세**: 제조경비 상세 내역
8. **경영실적**: 최종 경영실적 분석

### 데이터 구조

#### 제품목록
| 필드명 | 설명 | 예시 |
|--------|------|------|
| 제품ID | 고유 식별자 | P001 |
| 제품명 | 제품 이름 | 가니미소400g |
| 카테고리 | 제품 분류 | 수산가공품 |
| 제품무게 | 제품 무게(g) | 400 |
| 단위 | 판매 단위 | 개 |
| 설명 | 제품 설명 | 대게내장을 이용한 조미료 |
| 등록일 | 등록 날짜 | 2024-01-01 |

#### 부자재목록
| 필드명 | 설명 | 예시 |
|--------|------|------|
| 부자재ID | 고유 식별자 | M001 |
| 부자재명 | 부자재 이름 | 대게내장[붉은대게자숙장] |
| 카테고리 | 분류 | 원료/포장재료/조미료 |
| 단위 | 단위 | kg/개 |
| 단가 | 단가(원) | 5300 |
| 개당무게 | 개당 무게(kg) | 1.0 |
| 기본배합비율 | 기본 배합비율(%) | 92.5 |
| 공급업체 | 공급업체명 | 수산업체A |
| 설명 | 부자재 설명 | 대게 내장 원료 |
| 등록일 | 등록 날짜 | 2024-01-01 |

## 📖 사용법

### 1. 구글 시트 인증
1. 프로그램 실행 후 사이드바에서 "구글 서비스 계정 키 파일 업로드"
2. 다운로드한 JSON 키 파일 업로드
3. 스프레드시트 ID 입력 (템플릿 생성 시 제공된 ID)

### 2. 데이터 관리
#### 제품 관리
- **제품 목록 조회**: 등록된 모든 제품 확인
- **새 제품 추가**: 제품 ID, 제품명, 카테고리 등 입력
- **제품 정보 수정**: 기존 제품 정보 업데이트
- **제품 삭제**: 불필요한 제품 삭제

#### 부자재 관리
- **부자재 목록 조회**: 등록된 모든 부자재 확인
- **새 부자재 추가**: 부자재 ID, 부자재명, 카테고리 등 입력
- **부자재 정보 수정**: 기존 부자재 정보 업데이트
- **부자재 삭제**: 불필요한 부자재 삭제

### 3. 원가계산
#### 원료비 계산
1. "원료비" 탭에서 부자재 목록의 원료 선택
2. 배합비율 및 단가 자동 입력 (부자재 정보 기반)
3. 필요시 배합비율 및 단가 수정
4. 실시간 계산 결과 확인

#### 포장비 계산
1. "포장비" 탭에서 부자재 목록의 포장재료 선택
2. 단가, 수량, 개당 무게 자동 입력
3. 필요시 수량 및 단가 수정
4. 실시간 계산 결과 확인

#### 노무비 및 제조경비
- 기존 계산 로직과 동일
- 일일생산량 비율, 시급, 근무시간, 근로자 수 입력
- 자동 계산 및 결과 표시

### 4. 계산 기록 관리
- 모든 계산 결과는 자동으로 구글 시트에 저장
- 계산 이력 조회 및 분석 가능
- 과거 계산 결과와 비교 분석

## 🔧 고급 기능

### 데이터 백업 및 복원
- 구글 시트의 모든 데이터는 클라우드에 자동 저장
- 여러 사용자가 동시에 접근 가능
- 데이터 변경 이력 추적

### 실시간 동기화
- 부자재 가격 변경 시 즉시 반영
- 새로운 제품 추가 시 즉시 계산에 활용
- 계산 결과의 실시간 업데이트

### 데이터 분석
- 제품별 원가 비교 분석
- 부자재별 비용 분석
- 시계열 원가 변화 추이 분석

## 📁 파일 구조

```
product_cost/
├── cost_calculator_with_sheets.py    # 구글시트 연동 메인 프로그램
├── google_sheets_manager.py          # 구글시트 관리 클래스
├── create_google_sheets_template.py  # 구글시트 템플릿 생성
├── cost_calculator.py               # 기존 원가계산 프로그램
├── requirements.txt                 # 필요한 패키지 목록
├── README.md                       # 기본 사용법
└── README_GOOGLE_SHEETS.md        # 구글시트 연동 사용법
```

## 💡 특징

- **중앙 집중식 데이터 관리**: 구글 시트를 통한 모든 데이터의 중앙 관리
- **실시간 동기화**: 데이터 변경 시 즉시 모든 사용자에게 반영
- **확장성**: 새로운 제품과 부자재를 쉽게 추가
- **이력 관리**: 모든 계산 결과의 자동 저장 및 조회
- **협업 가능**: 여러 사용자가 동시에 접근하여 작업 가능

## 🔒 보안

- 구글 서비스 계정을 통한 안전한 인증
- 구글 시트의 권한 관리 시스템 활용
- 데이터 접근 권한의 세밀한 제어

## 📞 문의사항

구글 시트 연동 시스템 사용 중 문제가 있거나 개선사항이 있으시면 언제든지 문의해 주세요. 